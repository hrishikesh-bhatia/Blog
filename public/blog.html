
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Blog Page - Blogsmith</title>
  <link rel="stylesheet" href="/css/blog.css">
</head>
<body>
  <header>
    <h1>All Blog Posts</h1>
  </header>
  <main id="blog-list">
    <!-- Blog posts will be dynamically inserted here using JS -->
  </main>

  <script>
    // Fetch all blogs and display them in the blog.html
    document.addEventListener('DOMContentLoaded', () => {
      fetch('/api/blogs/get', {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${getCookie('logintoken')}`,  // Passing JWT token from cookies
        },
      })
        .then((res) => res.json())
        .then((data) => {
          const blogList = document.getElementById('blog-list');
          data.allblogs.forEach((blog) => {
            const blogItem = document.createElement('div');
            blogItem.classList.add('blog-item');
            blogItem.innerHTML = `
              <h2>${blog.title}</h2>
              <p>${blog.content}</p>
              <button onclick="viewBlog('${blog._id}')">View Blog</button>
            `;
            blogList.appendChild(blogItem);
          });
        })
        .catch((err) => console.log('Error:', err));
    });

    // Function to view a single blog
    function viewBlog(id) {
      window.location.href = `/blog.html?id=${id}`;
    }

    // Helper function to get cookies
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
    }
  </script>
</body>
</html>
